knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggplot2) #technically included in tidyverse
library(sf)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggplot2) #technically included in tidyverse
library(sf)
library(tidyverse)
library(ggplot2) #technically included in tidyverse
library(sf)
```{r libraries to load, echo=FALSE, message=TRUE}
library(tidyverse)
library(ggplot2) #technically included in tidyverse
library(sf)
library(tidyverse)
library(ggplot2) #technically included in tidyverse
library(sf)
#name files
p.counties <- "../data/CBW/County_Boundaries.shp"
p.stations <- "../data/CBW/Non-Tidal_Water_Quality_Monitoring_Stations_in_the_Chesapeake_Bay.shp"
#Read files in sf package
d.counties <- sf::read_sf(p.counties)
#name files
p.counties <- "../data/County_Boundaries.shp"
p.stations <- "../data/Non-Tidal_Water_Quality_Monitoring_Stations_in_the_Chesapeake_Bay.shp"
#Read files in sf package
d.counties <- sf::read_sf(p.counties)
#name files
p.counties <- "./data/County_Boundaries.shp"
p.stations <- "./data/Non-Tidal_Water_Quality_Monitoring_Stations_in_the_Chesapeake_Bay.shp"
#Read files in sf package
d.counties <- sf::read_sf(p.counties)
d.stations <- sf::read_sf(p.stations)
# check for validity
d.stations %>% sf::st_is_valid()
d.counties %>% sf::st_is_valid() # returns false for one feature, so we need to fix
# fix it "in place"
d.counties <- d.counties %>% sf::st_make_valid()
d.counties %>% dplyr::select(GEOID10, ALAND10) %>% head()
# head truncates the data.frame to the first n rows
d.counties %>% dplyr::select(-NAME10) %>% head()
d.counties %>% dplyr::select(GEOID10:CLASSFP10) %>% head()
d.counties %>% dplyr::select(-(GEOID10:CLASSFP10)) %>% head()
d.counties %>% dplyr::select(starts_with("C"))
d.counties %>% group_by(STATEFP10) %>% mutate(stateLandArea = sum(ALAND10))
d.counties %>%
as_tibble() %>% dplyr::select(-geometry) %>% # this line converts the data because of wonky geometry
group_by(STATEFP10) %>%
summarise(stateLandArea = sum(ALAND10))
d.counties %>%
ggplot(., aes(x = as.factor(STATEFP10), y = ALAND10)) +
geom_boxplot(aes(fill = STATEFP10))
d.counties %>%
ggplot(., aes(x = ALAND10)) +
geom_histogram(aes(fill = STATEFP10)) +
labs(title = "not the most useful plot, but you get the idea")
d.counties %>% sf::st_crs()
d.stations %>% sf::st_crs()
d.counties %>% sf::st_crs() == d.stations %>% sf::st_crs()
del.counties <- d.counties %>% dplyr::filter(STATEFP10 == 10)
del.stations <- sf::st_intersection(d.stations, del.counties)
del.counties %>% st_area()
View(d.counties)
d.counties %>%
mutate(., ALAND10 + AWATER10 = TotArea) %>%
d.counties %>%
mutate(., TotArea = ALAND10 + AWATER10) %>%
summarize(., PcntLand = (ALAND10 / TotArea)*100)
d.counties %>%
mutate(., TotArea = ALAND10 + AWATER10)
#%>%
summarize(., PcntLand = (ALAND10 / TotArea)*100)
